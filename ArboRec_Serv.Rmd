---
title: "ArboRec Serv"
author: "BVPN"
date: "29/02/2020"
output: html_document
---

```{r setup, include=FALSE}
library(readr)
library(bnlearn)
library(e1071)
library(caret)

ArboRec <- read_delim("ArboRec.csv", ";", escape_double = FALSE, trim_ws = TRUE)

ArboRec$tp_classificacao_final <- as.factor(ArboRec$tp_classificacao_final)


particaoArbo = createDataPartition(1:nrow(ArboRec), p=.7) 
treinoArbo = ArboRec[particaoArbo$Resample1,] 
testeArbo = ArboRec[- particaoArbo$Resample1,] 

arboNaiveBayes = naiveBayes(tp_classificacao_final ~  notificacao_ano + ds_semana_notificacao + no_bairro_residencia + co_distrito_residencia + co_logradouro_residencia + tp_sexo + tp_raca_cor + tp_escolaridade + tp_zona_residencia + tp_result_exame, treinoArbo)

arboNaiveBayes

previsaoArbo = predict(arboNaiveBayes, testeArbo) 
confusionMatrix(previsaoArbo, testeArbo$tp_classificacao_final)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r , include=TRUE}
plot(ArboRec$tp_classificacao_final)
confusionMatrix(previsaoArbo, testeArbo$tp_classificacao_final)


```